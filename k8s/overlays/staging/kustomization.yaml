apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: staging

resources:
- ../../base

patchesStrategicMerge:
- deployment-patch.yaml
- configmap-patch.yaml

images:
- name: ghcr.io/lavoro-ai-ferri/backend
  newTag: staging

replicas:
- name: lavoro-backend
  count: 2

commonLabels:
  environment: staging
  version: staging

configMapGenerator:
- name: lavoro-config-staging
  literals:
  - cors-origin=https://staging.lavoro-ai-ferri.com
  - log-level=debug
  - rate-limit-max-requests=200

secretGenerator:
- name: lavoro-secrets-staging
  literals:
  - jwt-secret=staging-jwt-secret-change-in-production
  - jwt-refresh-secret=staging-jwt-refresh-secret-change-in-production
